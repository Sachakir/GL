<!DOCTYPE HTML>
<html xmlns:th="http://www.thymeleaf.org">
<head>
	<title th:utext="${title}"></title>
	<meta charset="utf-8">
	<link href="assets/css/bootstrap.css" rel="stylesheet">
	<link rel="stylesheet" href="/assets/css/style.css" />
	<link href='assets/css/calendrier.css' rel='stylesheet' />
	<link href='assets/css/calendrier.print.css' rel='stylesheet' media='print' />



</head>

<body>
	
	<div class="container">
		<div th:replace="~{navBar :: #navBar}"></div>
		<section class="row">
			
			<div id='calendar' class="col-md-5 " ></div>
			<div class = " col-md-4 col-md-offset-6">

				<div class="panel panel-primary table-responsive" value="17/02/2019" >
					<table class="table table-striped table-condensed w-auto" id="listConge">
						<div class="panel-heading"> 
							<h3 class="panel-title">Liste des utilisateurs</h3>
						</div>
						<thead>
							<tr>
								<th>uid</th>
								<th>Date de début</th>
								<th>Date de fin</th>
								
							</tr>
						</thead>
						<tbody>
							<tr th:if="${listConges.empty}">
								<td colspan="2">Personne n'est en congé!</td>
							</tr>
							<tr th:each="conges : ${listConges}">
								<td><span th:text="${conges.uid}"> uid </span></td>	
								<td><span th:text="${conges.datedebut}"> Date de début </span></td>
								<td><span th:text="${conges.datefin}"> Date de fin </span></td>
								
											
							</tr>
						</tbody>
					</table>
					
				</div>
				<h4>Mes congés</h4>
				<h6>Jour(s) de congé(s) payé(s) restant(s) :xx</h6>
				<h6>RTT(s) restant(s) : 0.0</h6>
			</div>
			
		</section>
		

		
	</div>


	<script src="assets/js/jquery.js"></script>
	<script src="assets/js/bootstrap.js"></script>
	<script src="assets/js/scripts.js"></script>

	<script src='assets/js/moment.min.js'></script>
	<script src='assets/js/calendrier.js'></script>

	<script type="text/javascript" th:inline="javascript">
		$(document).ready(function() {

			$('#calendar').fullCalendar({
				defaultDate: '2019-01-12',
				editable: true,
				  eventLimit: true,
				  selectable: true,
				  events: [
				  {
					title: 'All Day Event',
					start: '2019-01-01'
				  },
				  {
					title: 'Long Event',
					start: '2019-01-07',
					end: '2019-01-10'
				  },
				  {
					id: 999,
					title: 'Repeating Event',
					start: '2019-01-09T16:00:00'
				  },
				  {
					id: 999,
					title: 'Repeating Event',
					start: '2019-01-16T16:00:00'
				  },
				  {
					title: 'Conference',
					start: '2019-01-11',
					end: '2019-01-13'
				  },
				  
				  ],
				dayClick: function(date, jsEvent, view) {
					
					$("#listConge tr>td").remove();
					/*<![CDATA[*/
						

						var cs = [[${toutConges}]];
						

						
					/*]]>*/
					var _months = { 
						  "Jan" : "01", 
						  "Feb" : "02",
						  "Mar" : "03",
						  "Apr" : "04",
						  "May" : "05",
						  "Jun" : "06",
						  "Jul" : "07",
						  "Aug" : "08",
						  "Sep" : "09",
						  "Oct" : "10",
						  "Nov" : "11",
						  "Dec" : "12"
					  };
					
					cs.forEach(function(element){
						var newRow = $("<tr>");
						var cols = "";
						var jourDebut = element.datedebut.substring(0,2);
						var jourFin = element.datefin.substring(0,2);
						var moisDebut = element.datedebut.substring(3,5);
						var moisFin = element.datefin.substring(3,5);
						var anneeDebut = element.datedebut.substring(6,10);
						var anneeFin = element.datefin.substring(6,10);
						var jour = date.toString().substring(8,10);
						var annee = date.toString().substring(11,15);
						var mois = _months[date.toString().substring(4,7)];
						if(annee>=anneeDebut && annee<=anneeFin){
							if(mois>=moisDebut && mois<=moisFin){
								if(jour>=jourDebut && jour<=jourFin){
									cols+='<td> month: '+ mois + ' annee: '+annee+' jour: ' + jour+'</td>	';
									cols+='<td>'+ element.datedebut + '</td>	';
									cols += '<td>' + element.datefin + '</td>';
									newRow.append(cols);
									$("#listConge").append(newRow);
								}
							}
						}
						
						
					});
					
				}
			  }
			  
			  );
			
		});
	</script>

</body>
</html>
		
		
	
	
	
	
	
